# rag-python
ML/LLM experiments with Llama Index to develop a personal assistant for cognitive impaired patients.

## Index

- [Setup](#setup)
  - [Python scripts](#python-scripts)
  - [Ollama](#ollama)
- [Experiments](#experiments)
  - [01-use-local-knowledge](#01-use-local-knowledge)
  - [02-chat-bot](#02-chat-bot)
  - [03-fine-tuning](#03-fine-tuning)
  - [04-training-with-colab](#04-training-with-colab)
  - [05-create-a-bio](#05-create-a-bio)
  - [06-sentence-split](#06-sentence-split)
  - [07-rag-pipeline](#07-rag-pipeline)
  - [08-query-chroma](#08-query-chroma)
  - [09-refiner](#09-refiner)
  - [10-keywords-extraction](#10-keywords-extraction)
  - [11-query-chroma-with-kw](#11-query-chroma-with-kw)
  - [12-faiss](#12-faiss)
- [Datasets](#datasets)

Alternative indexing techniques using the FAISS library.

## Setup

### Python scripts

`Python 3.11` is unsupported by `Pytorch`. The application must run with `Python 3.10`.

Install dependencies:
```shell
pip install -r requirements.txt
# additional dependencies
pip install pypdf fastembed chromadb accelerate streamlit langchainhub
```

In some scripts, the value `device` must reflect the hardware:
- `auto` is the default 
- `cpu` should always work, but processing time will be too long
- `mps` to use M1

Some scripts connect to HuggingFace. Set the following environment variables:
- `HF_HOME=path`: path of the HuggingFace cache
- `HUGGING_FACE_HUB_TOKEN=token`: HuggingFace token to download the models

### Ollama

Ollama is required for most scripts.

Install `ollama`:

```shell
brew install ollama
mkdir -p ~/.ollama
# optional to store the models on an external drive
ln -s "/{PATH}/ollama" ~/.ollama/models
ollama serve
ollama pull mistral
ollama pull llama2
```

Run it:

```shell
ollama serve
ollama run llama2
```

That should open an interactive shell to chat with Llama2.

## Experiments

### 01-use-local-knowledge

Basic experiment using `llama-index` and `llama` to index and query a dataset. [README](01-use-local-knowledge/README.md).

### 02-chat-bot

Experiment using `ollama`/`llama2` + `streamlit`/`landchan`/`chromadb` to discuss a PDF with the LLM. [README](02-chat-bot/README.md).

### 03-fine-tuning

Experiment fine-tuning `bert` with a dataset of reviews. [README](03-fine-tuning/README.md).

### 04-training-with-colab

Same as 03, but using Colab. [README](04-training-with-colab/README.md).

### 05-create-a-bio

Generate knowledge with LLMs and use the results to build the knowledge base for further iterations. [README](5-create-a-bio/README/.md).

### 06-sentence-split

Evaluates how SentenceSplitter works. [README](06-sentence-split/README.md).

### 07-rag-pipeline

Variation of 06-sentence-split. [README](07-rag-pipeline/README.md).

### 08-query-chroma

Test to verify how Chroma retrieves knowledge based on queries and filters. [README](08-query-chroma/README.md).

### 09-refiner

Utilisation of LLMs to re-rank results from the vector database. [README](09-refiner/README.md).

### 10-keywords-extraction

Methods to extract keywords (or key-phrases) from a text. [README](10-keywords-extraction/README.md).

### 11-query-chroma-with-kw

Use keywords to pre-filter the nodes returned by a query. [README](11-query-chroma-with-kw/README.md).

### 12-faiss

Alternative indexing techniques using the FAISS library. [README](12-faiss/README.md).

## Datasets

- bio: the bio of a fictional woman generated by an [05-create-a-bio](05-create-a-bio/README.md).
- bio-single-file: like _bio_ but in a single file.
- dementia-wiki-txt: an extract of the [Wikipedia page about dementia](https://en.wikipedia.org/wiki/Dementia).
- dementia-wiki-polluted: same as _dementia-wiki-txt_ but polluted by a sentence affirming that there exists a relation between dementia and alien kidnapping (to study hallucinations).
- TwentyThousandLeaguesUnderTheSea: _Twenty Thousand Leagues Under the Seas_ by Jules Verne. Source: [https://www.gutenberg.org/](https://www.gutenberg.org/)
- gutenberg: five books from [https://www.gutenberg.org/](https://www.gutenberg.org/). _On the Origin of Species By Means of Natural Selection_ by Charles Darwin, _Paradise Lost_ by John Milton, _The Fall of the House of Usher_ by Edgar Allan Poe, _The Republic_ by Plato, and _Twenty Thousand Leagues under the Sea_ by Jules Verne.
